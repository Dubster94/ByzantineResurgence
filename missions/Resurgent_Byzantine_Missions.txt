#Written by Dub
#Every single one of these missions that deals with multiple provinces uses province groups for designating provinces, because I keep repeating the same code every time. As such it's simpler to refer to them there instead.
#If you want to check the province IDs, check provincegroup.txt in the map folder.

byz_economic_1 = {
	slot = 1
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	byz_refill_imperial_treasury = { #Refill Imperial Treasury
		icon = mission_war_chest
		position = 1 #1-1
		required_missions = {}
		
		provinces_to_highlight = {
			#None
		}
		
		trigger = {
			treasury = 250
			share_of_starting_income = 7 #Byzantium starts with 7.24 starting income. This should in theory require about 50 ducats/month.
			NOT = { num_of_loans = 1 }
			NOT = { inflation = 0.1 }
		}
		
		effect = {
			define_advisor = {
				type = treasurer
				skill = 3
				discount = yes
			}
			define_advisor = {
				type = master_of_mint
				skill = 3
				discount = yes
			}
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}

	byz_revive_hyperpyron = { #New in BR 8.0
		icon = mission_establish_mint_towns
		position = 2 #1-2
		required_missions = { byz_refill_imperial_treasury }
		
		provinces_to_highlight = {
			trade_goods = gold
			has_discovered = ROOT
		}
		
		trigger = {
			trade_goods_produced_amount = {
				trade_goods = gold
				amount = 2 #This corresponds to 20 production dev in gold provinces. Byzantium has 4 potential gold provinces to collect from, so this should be fairly easy.
			}
		}
		
		effect = {
			add_years_of_income = 2.5
			remove_country_modifier = byz_bad_economy
			add_country_modifier = {
				name = "byz_restored_hyperpyron"
				duration = 9125
			}
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
	
	byz_restore_crown_authority = { #New in BR 8.0
		icon = mission_crown_authority
		position = 3 #1-3
		required_missions = { byz_revive_hyperpyron byz_state_trade_hegemon }
		
		provinces_to_highlight = {
		}
		
		trigger = {
			crown_land_share = 0.5
			NOT = { average_home_autonomy = 0.1 }
		}
		
		effect = {
			add_country_modifier = {
				name = "byz_crown_authority_restored"
				duration = -1
			}
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
}

byz_economic_2 = {
	slot = 2
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	
	byz_state_trade_hegemon = { #New in BR 8.0
		icon = mission_dominate_home_trade_node
		position = 2 #2-2
		required_missions = { byz_refill_imperial_treasury }
		
		provinces_to_highlight = {
			OR = {
				province_group = byz_no_latins_in_greece_provinces
				province_group = byz_retake_greek_islands_provinces
				province_group = byz_reconquer_west_anatolia_provinces
				province_group = byz_reconquer_ottoman_greece_provinces
				province_group = byz_deny_ottoman_access_provinces
			}
			owner = {
				has_government_attribute = is_merchant_republic
			}
		}
		
		trigger = {
			1320 = { #Constantinople
				trade_share = {
					country = ROOT
					share = 0.75
				}
			}
			5493 = { #Aegean Sea
				trade_share = {
					country = ROOT
					share = 0.75
				}
			}
			custom_trigger_tooltip = {
				tooltip = byz_restore_trade_hegemon
				byz_no_latins_in_greece_provinces = {
					type = all
					owner = {
						NOT = { has_government_attribute = is_merchant_republic }
					}
				}
				byz_retake_greek_islands_provinces = {
					type = all
					owner = {
						NOT = { has_government_attribute = is_merchant_republic }
					}
				}
				byz_reconquer_west_anatolia_provinces = {
					type = all
					owner = {
						NOT = { has_government_attribute = is_merchant_republic }
					}
				}
				byz_reconquer_ottoman_greece_provinces = {
					type = all
					owner = {
						NOT = { has_government_attribute = is_merchant_republic }
					}
				}
				byz_deny_ottoman_access_provinces = {
					type = all
					owner = {
						NOT = { has_government_attribute = is_merchant_republic }
					}
				}
			}
		}
		
		effect = {
			add_mercantilism = 5
			add_country_modifier = {
				name = "byz_restored_trade_hegemon"
				duration = 9125
			}
			151 = {
				add_base_tax = 1
				add_base_production = 1
			}
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}

}

byz_religious_tree = {
	slot = 1
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes

	byz_question_of_schismatics = { #A Question of Schismatics
		icon = mission_pf_cross
		position = 5 #1-5
		required_missions = { byz_reconquer_ottoman_greece }
		
		provinces_to_highlight = {
			OR = {
				province_group = byz_deny_ottoman_access_provinces
				province_group = byz_reconquer_ottoman_greece_provinces
				province_group = byz_no_latins_in_greece_provinces
			}
			NOT = { religion = ROOT }
		}
		
		trigger = {
			OR = {
				AND = {
					religion = orthodox
					custom_trigger_tooltip = {
						tooltip = obj_convert_10_provinces_tooltip
						check_variable = { which = num_converted_religion value = 10 }
					}
				}
				AND = {
					religion = catholic
					151 = { religion = catholic }
				}
			}
			temple = 15
			custom_trigger_tooltip = {
				tooltip = byz_question_of_schismatics_tooltip
				NOT = {
					OR = {
						byz_deny_ottoman_access_provinces = {
							NOT = { religion = ROOT }
						}
						byz_reconquer_ottoman_greece_provinces = {
							NOT = { religion = ROOT }
						}
						byz_no_latins_in_greece_provinces = {
							NOT = { religion = ROOT }
						}
					}
				}
			}
		}
		
		effect = {
			increase_religious_currency_effect = yes
			if = {
				limit = {
					ruler_religion = catholic
					religion = orthodox
				}
				set_ruler_religion = orthodox
			}
			if = {
				limit = {
					heir_religion = catholic
					religion = orthodox
				}
				set_heir_religion = orthodox
			}
			if = {
				limit = {
					religion = orthodox
				}
				add_estate_loyalty = {
					estate = estate_church
					loyalty = 10
				}
				add_estate_loyalty_modifier = {
					estate = estate_church
					desc = EST_REMAINED_ORTHODOX
					loyalty = 10
					duration = -1
				}
			}
		}
	
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
	
	convert_asia_minor = { #Directly taken from vanilla Byzantine Missions
		icon = mission_hands_praying
		required_missions = { byz_question_of_schismatics byz_reconquer_west_anatolia }
		position = 7 #1-7
		
		provinces_to_highlight = {
			province_group = byz_reconquer_west_anatolia_provinces
			OR = {
				NOT = { religion = ROOT }
				NOT = { owned_by = ROOT }
			}
		}
		
		trigger = {
			has_fulfiled_province_requirement_for_mission_trigger = {
				tooltip=country_holds_or_non_sovereign_subject_holds_highlighted 
				provinces=byz_reconquer_west_anatolia_provinces
				owner_type=country_or_non_sovereign_subject_holds
			}
			has_fulfiled_province_requirement_for_mission_trigger = {
				tooltip=highlighted_provinces_converted_to_religion 
				provinces=byz_reconquer_west_anatolia_provinces
				owner_type=religion
			}
		}
		
		effect = {
			if = {
				limit = {
					religion = orthodox
				}
				add_country_modifier = {
					name = "growth_of_the_orthodox_church"
					duration = 7300
				}
				add_estate_loyalty = {
					estate = estate_church
					loyalty = 10
				}
			}
			increase_religious_currency_effect = yes
		}
	
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
	
	convert_anatolia = { #Convert Anatolia
		icon = mission_religious
		required_missions = { convert_asia_minor byz_reclaim_anatolia }
		position = 11 #1-11
		provinces_to_highlight = {
			province_group = byz_reclaim_anatolia_provinces
			OR = {
				NOT = { religion = ROOT }
				NOT = { owned_by = ROOT }
			}
		}
		
		trigger = {
			has_fulfiled_province_requirement_for_mission_trigger = {
				tooltip=country_holds_or_non_sovereign_subject_holds_highlighted 
				provinces=byz_reclaim_anatolia_provinces
				owner_type=country_or_non_sovereign_subject_holds
			}
			has_fulfiled_province_requirement_for_mission_trigger = {
				tooltip=highlighted_provinces_converted_to_religion 
				provinces=byz_reclaim_anatolia_provinces
				owner_type=religion
			}
		}
		
		effect = {
			if = {
				limit = {
					religion = orthodox
				}
				add_country_modifier = {
					name = "growth_of_the_orthodox_church"
					duration = 7300
				}
				add_estate_loyalty = {
					estate = estate_church
					loyalty = 10
				}
			}
			increase_religious_currency_effect = yes
		}
	
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
}

byz_reconquest_2 = {
	slot = 2
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	byz_reconquer_ottoman_greece = { #Ottomans out of Greece
		icon = mission_unite_home_region
		position = 4 #2-4
		required_missions = { byz_deny_ottoman_access }
		
		provinces_to_highlight = {
			province_group = byz_reconquer_ottoman_greece_provinces
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			OR = {
				has_fulfiled_province_requirement_for_mission_trigger = {
					tooltip=country_holds_or_non_sovereign_subject_holds_highlighted 
					provinces=byz_reconquer_ottoman_greece_provinces
					owner_type=country_or_non_sovereign_subject_holds
				}
				custom_trigger_tooltip = {
					tooltip = byz_turn_the_tide_tooltip
					NOT = {
						OR = {
							byz_deny_ottoman_access_provinces = {
								owned_by = TUR
							}
							byz_reconquer_ottoman_greece_provinces = {
								owned_by = TUR
							}
						}
					}
				}
			}
		}
		
		effect = {
			add_country_modifier = {
				name = "byzantium_resurgent"
				duration = 5475
			}
			
			#Claims
			give_permaclaims_for_mission = { mission=byz_reconquer_west_anatolia }
			give_permaclaims_for_mission = { mission=byz_safeguard_balkan_border }
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}

	byz_reconquer_west_anatolia = { #Recover West Anatolia
		icon = mission_theodosian_walls
		position = 6 #2-6
		required_missions = { byz_reconquer_ottoman_greece }
		
		provinces_to_highlight = {
			province_group = byz_reconquer_west_anatolia_provinces
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			has_fulfiled_province_requirement_for_mission_trigger = {
				tooltip=country_holds_or_non_sovereign_subject_holds_highlighted 
				provinces=byz_reconquer_west_anatolia_provinces
				owner_type=country_or_non_sovereign_subject_holds
			}
		}
		
		effect = {			
			#Dev bonuses
			316 = { #Nicomedia
				add_base_tax = 3
				add_base_manpower = 3
				if = {
					limit = {
						has_global_flag = byz_byzantine_silk_restored
					}
					change_trade_goods = silk
				}
			}
			5157 = { #Nicaea
				add_base_tax = 3
				add_base_production = 3
				if = {
					limit = {
						has_global_flag = byz_favored_glassmakers
					}
					add_base_production = 2
					add_or_spawn_center_of_trade = { level = 2 }
				}
			}
			random_owned_province = { #RandProv 1
				limit = {
					province_group = byz_reconquer_west_anatolia_provinces
					NOT = { #To prevent picking Nicaea/Nicomedia
						province_id = 316
						province_id = 5157
					}
				}
				add_base_tax = 1
				add_base_manpower = 1
				set_province_flag = byz_prov_1_to_dev #To prevent same province picked twice in practice
			}
			random_owned_province = { #RandProv 2
				limit = {
					province_group = byz_reconquer_west_anatolia_provinces
					NOT = { #To prevent picking Nicaea/Nicomedia
						province_id = 316
						province_id = 5157
						has_province_flag = byz_prov_1_to_dev #To prevent same province picked twice in practice
					}
				}
				add_base_tax = 1
				add_base_manpower = 1
			}
			hidden_effect = { #Clearing the flag above.
				every_owned_province = {
					limit = {
						has_province_flag = byz_prov_1_to_dev
					}
					clr_province_flag = byz_prov_1_to_dev 
				}
			}
			
			#Misc
			create_general = { tradition = 80 }
			
			#Claims
			give_permaclaims_for_mission = { mission=byz_reclaim_anatolia }
			#CB
			if = { #Trebizond
				limit = {
					does_tag_exist_and_have_less_than_provided_dev_trigger = {
						tag=TRE
						dev=200
					}
				}
				add_casus_belli = {
					type = cb_vassalize_mission
					months = 300 #25 years. I'm not sure if you can actually make it infinite.
					target = TRE
				}
			}
			if = { #Epirus
				limit = {
					does_tag_exist_and_have_less_than_provided_dev_trigger = {
						tag=EPI
						dev=200
					}
				}
				add_casus_belli = {
					type = cb_vassalize_mission
					months = 300 #25 years. I'm not sure if you can actually make it infinite.
					target = EPI
				}
			}
			if = { #Cappadocia
				limit = {
					does_tag_exist_and_have_less_than_provided_dev_trigger = {
						tag=CAP
						dev=200
					}
				}
				add_casus_belli = {
					type = cb_vassalize_mission
					months = 300 #25 years. I'm not sure if you can actually make it infinite.
					target = CAP
				}
			}
		}
	
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}

	byz_reclaim_anatolia = { #Anatolian Reclamation
		icon = mission_empire
		position = 10 #2-10
		required_missions = { byz_reconquer_west_anatolia }
		
		provinces_to_highlight = {
			OR = {
				AND = {
					province_group = byz_reclaim_anatolia_provinces
					NOT = { country_or_non_sovereign_subject_holds = ROOT }
				}
				owner = { #Added because people don't understand Aq Qoyunlu is Turkish culture.
					primary_culture = turkish
				}
			}
		}
		
		trigger = {
			has_fulfiled_province_requirement_for_mission_trigger = {
				tooltip=country_holds_or_non_sovereign_subject_holds_highlighted 
				provinces=byz_reclaim_anatolia_provinces
				owner_type=country_or_non_sovereign_subject_holds
			}
			custom_trigger_tooltip = {
				tooltip = byz_no_turkish_country
				NOT = {
					any_country = {
						primary_culture = turkish
					}
				}
			}
			
			NOT = { exists = TRE }
			NOT = { exists = EPI }
			NOT = { exists = CAP }
		}
		
		effect = {
			add_country_modifier = {
				name = "byzantium_resurgent"
				duration = 5475
			}
			
			#Dev bonuses
			326 = { #Ancyra
				add_base_tax = 3
				add_base_manpower = 3
			}
			151 = { #Constantinople
				add_base_tax = 3
				add_base_production = 3
			}
			random_owned_province = { #RandProv 1
				limit = {
					province_group = byz_reclaim_anatolia_provinces
					NOT = { #To prevent picking Ancyra
						province_id = 326
					}
				}
				add_base_tax = 1
				add_base_manpower = 1
				set_province_flag = byz_prov_1_to_dev #To prevent same province picked twice in practice
			}
			random_owned_province = { #RandProv 2
				limit = {
					province_group = byz_reclaim_anatolia_provinces
					NOT = { #To prevent picking Ancyra
						province_id = 326
						has_province_flag = byz_prov_1_to_dev #To prevent same province picked twice in practice
					}
				}
				add_base_tax = 1
				add_base_manpower = 1
				set_province_flag = byz_prov_2_to_dev #To prevent same province picked twice in practice
			}
			random_owned_province = { #RandProv 3
				limit = {
					province_group = byz_reclaim_anatolia_provinces
					NOT = { #To prevent picking Ancyra
						province_id = 326
						has_province_flag = byz_prov_1_to_dev #To prevent same province picked twice in practice
						has_province_flag = byz_prov_2_to_dev #To prevent same province picked twice in practice
					}
				}
				add_base_tax = 1
				add_base_manpower = 1
				set_province_flag = byz_prov_3_to_dev #To prevent same province picked twice in practice
			}
			random_owned_province = { #RandProv 4
				limit = {
					province_group = byz_reclaim_anatolia_provinces
					NOT = { #To prevent picking Ancyra
						province_id = 326
						has_province_flag = byz_prov_1_to_dev #To prevent same province picked twice in practice
						has_province_flag = byz_prov_2_to_dev #To prevent same province picked twice in practice
						has_province_flag = byz_prov_3_to_dev #To prevent same province picked twice in practice
					}
				}
				add_base_tax = 1
				add_base_manpower = 1
				set_province_flag = byz_prov_4_to_dev #To prevent same province picked twice in practice
			}
			random_owned_province = { #RandProv 5
				limit = {
					province_group = byz_reclaim_anatolia_provinces
					NOT = { #To prevent picking Ancyra
						province_id = 326
						has_province_flag = byz_prov_1_to_dev #To prevent same province picked twice in practice
						has_province_flag = byz_prov_2_to_dev #To prevent same province picked twice in practice
						has_province_flag = byz_prov_3_to_dev #To prevent same province picked twice in practice
						has_province_flag = byz_prov_4_to_dev #To prevent same province picked twice in practice
					}
				}
				add_base_tax = 1
				add_base_manpower = 1
			}
			hidden_effect = { #Clearing the flags above.
				every_owned_province = {
					limit = {
						has_province_flag = byz_prov_1_to_dev
					}
					clr_province_flag = byz_prov_1_to_dev 
				}
				every_owned_province = {
					limit = {
						has_province_flag = byz_prov_2_to_dev
					}
					clr_province_flag = byz_prov_2_to_dev 
				}
				every_owned_province = {
					limit = {
						has_province_flag = byz_prov_3_to_dev
					}
					clr_province_flag = byz_prov_3_to_dev 
				}
				every_owned_province = {
					limit = {
						has_province_flag = byz_prov_4_to_dev
					}
					clr_province_flag = byz_prov_4_to_dev 
				}
			}
			
			custom_tooltip = reclaim_anatolia_tooltip
			hidden_effect = {
				byz_reconquer_west_anatolia_provinces = {
					add_province_modifier = {
						name = "byz_resettlement_act"
						duration = 18250
					}
				}
			}
			#Claims
			give_permaclaims_for_mission = { mission=byz_armenia_minor }
		}
	
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}

	byz_turkic_question = { #The Turkic Question
		icon = mission_non-western_cavalry_raid
		position = 11 #2-11
		required_missions = { byz_reclaim_anatolia }
		
		provinces_to_highlight = {
			if = {
				limit = {
					NOT = { accepted_culture = turkish }
				}
				region = anatolia_region
			}
			culture = turkish
		}
		
		trigger = {
			OR = {
				AND = {
					custom_trigger_tooltip = {
						tooltip = byz_owns_all_turkish_provinces_tooltip
						NOT = {
							any_province = {
								culture = turkish
								NOT = { owned_by = ROOT }
							}
						}
					}
					accepted_culture = turkish
				}
				NOT = {
					any_province = {
						region = anatolia_region
						culture = turkish
					}
				}
			}
		}
		
		effect = {
			if = {
				limit = {
					NOT = {
						any_province = {
							culture = turkish
							NOT = { owned_by = ROOT }
						}
					}
					accepted_culture = turkish
				}
				add_country_modifier = {
					name = "byz_turkic_cavalry"
					duration = 9125
				}
				custom_tooltip = br_turkic_cavalry_enabler_tt
				set_country_flag = br_turkic_cavalry_enabled
			}
			else_if = {
				limit = {
					any_province = {
						region = anatolia_region
						culture = turkish
					}
				}
				#Tooltip part.
				custom_tooltip = turkic_question_tooltip_1
				tooltip = {
					add_country_modifier = {
						name = "byz_turkic_cavalry"
						duration = 9125
					}
					custom_tooltip = br_turkic_cavalry_enabler_tt
				}
				custom_tooltip = turkic_question_tooltip_2
				add_country_modifier = {
					name = "byz_rid_of_turkish_influence"
					duration = 9125
				}
			}
			else = {
				add_country_modifier = {
					name = "byz_rid_of_turkish_influence"
					duration = 9125
				}
			}
			#Claims
		}
	
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
	
	byz_anatolian_restoration = { #Anatolian Restoration
		icon = mission_monarch_in_throne_room
		position = 12 #2-12
		required_missions = { byz_turkic_question }
		
		provinces_to_highlight = {
			region = anatolia_region
		}
		
		trigger = {
			development_in_provinces = { #Anatolia starts with 702 dev. (Used to be 665 in BT 13 and 593 dev in BT 12 with Bugfixes) I think this is a fair adjustment.
				value = 900 #750
				region = anatolia_region
			}
		}
		
		effect = {
			if = {
				limit = { has_dlc = "Mandate of Heaven"	}
				add_splendor = 200
			}
			anatolia_region = {
				add_province_modifier = {
					name = "byz_anatolian_restoration"
					duration = -1
				}
			}
			319 = { #To prep it for coal!
				add_base_tax = 7
				add_base_production = 7
			}
		}
	
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
}

byz_reconquest_1 = {
	slot = 3
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	byz_turn_the_tide = { #Turn the Tide
		icon = mission_constantinople
		position = 1 #3-1
		required_missions = {  } #None, first mission
		
		provinces_to_highlight = {
			#None
		}
		
		trigger = {
			OR = {
				war_with = TUR
				custom_trigger_tooltip = {
					tooltip = byz_turn_the_tide_tooltip
					NOT = {
						OR = {
							byz_deny_ottoman_access_provinces = {
								owned_by = TUR
							}
							byz_reconquer_ottoman_greece_provinces = {
								owned_by = TUR
							}
						}
					}
				}
			}
		}
		
		effect = {
			add_country_modifier = {
				name = "byz_last_stand"
				duration = 3650
			}
			
			#Claims
			give_cores_for_mission = { mission=byz_deny_ottoman_access }
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
	
	byz_deny_ottoman_access = { #Deny Ottomans Access
		icon = mission_pf_map_table
		position = 3 #1-3
		required_missions = { byz_turn_the_tide }
		
		provinces_to_highlight = {
			province_group = byz_deny_ottoman_access_provinces
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			OR = {
				has_fulfiled_province_requirement_for_mission_trigger = {
					tooltip=country_holds_or_non_sovereign_subject_holds_highlighted 
					provinces=byz_deny_ottoman_access_provinces
					owner_type=country_or_non_sovereign_subject_holds
				}
				custom_trigger_tooltip = {
					tooltip = byz_turn_the_tide_tooltip
					NOT = {
						OR = {
							byz_deny_ottoman_access_provinces = {
								owned_by = TUR
							}
							byz_reconquer_ottoman_greece_provinces = {
								owned_by = TUR
							}
						}
					}
				}
			}
		}
		
		effect = {
			4779 = { #Gallipoli
				change_religion = ROOT
				on_province_religion_converted_estate_privileges_effect = yes
				change_culture = ROOT
				add_base_tax = 2
				add_base_production = 2
				add_base_manpower = 1
				add_province_modifier = {
					name = "byz_resettle_gallipoli"
					duration = 5475
				}
			}
			
			#Claims
			give_cores_for_mission = { mission=byz_reconquer_ottoman_greece }
			give_cores_for_mission = { mission=byz_no_latins_in_greece }
			
			#Misc
			custom_tooltip = byz_reconquer_ottoman_greece_nationalism
			hidden_effect = {
				every_province = {
					limit = {
						region = balkan_region
						owned_by = TUR
					}
					add_nationalism = 30 #This effect is apparently modified by country modifiers. Thus, expect Ottomans to get only 20 years of separatism since they start as Conqueror personality and have years of separatism from some Misc change somewhere I can't recall.
				}
			}
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}

	byz_safeguard_balkan_border = { #Safeguard Constantinople (& Thessalonica!)
		icon = mission_assemble_an_army
		position = 5 #3-5
		required_missions = { byz_reconquer_ottoman_greece }
		
		provinces_to_highlight = {
			province_group = byz_safeguard_balkan_border_provinces
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			has_fulfiled_province_requirement_for_mission_trigger = {
				tooltip=country_holds_or_non_sovereign_subject_holds_highlighted 
				provinces=byz_safeguard_balkan_border_provinces
				owner_type=country_or_non_sovereign_subject_holds
			}
		}
		
		effect = {			
			#Effects:
			if = {
				limit = { has_dlc = "Mandate of Heaven" }
				thrace_area = {
					add_prosperity = 50
				}
				macedonia_area = {
					add_prosperity = 50
				}
				eastern_macedonia_area = {
					add_prosperity = 50
				}
			}
			
			#Claims & CBs
			if = { #Bulgaria
				limit = {
					exists = BUL
					BUL = {
						NOT = { total_development = 200 }
					}
				}
				add_casus_belli = {
					type = cb_vassalize_mission
					months = 300 #25 years. I'm not sure if you can actually make it infinite.
					target = BUL
				}
			}
			give_permaclaims_for_mission = { mission=byz_subjugate_bulgaria }
		}
	
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
}

byz_reconquest_3 = {
	slot = 4
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	byz_no_latins_in_greece = { #No Latins in Greece
		icon = mission_mediterranean_castle
		position = 4 #4-4
		required_missions = { byz_deny_ottoman_access }
		
		provinces_to_highlight = {
			province_group = byz_no_latins_in_greece_provinces
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			NOT = { exists = ATH }
			NOT = { exists = EPI }
			NOT = { exists = LES }
			has_fulfiled_province_requirement_for_mission_trigger = {
				tooltip=country_holds_or_non_sovereign_subject_holds_highlighted 
				provinces=byz_no_latins_in_greece_provinces
				owner_type=country_or_non_sovereign_subject_holds
			}
		}
		
		effect = {
			add_country_modifier = {
				name = "byz_latin_expulsion"
				duration = 5475
			}
			if = { #If Genoa controls Chios & has capital in Italy still (Genoa)
				limit = {
					exists = GEN
					GEN = { 
						capital_scope = {
							region = italy_region
						}
						owns = 2348 #Chios
					}
				}
				country_event = { id = resurgent_BYZ.14 }
			}
			else = {
				add_permanent_claim = 2348
			}
		
		}
	
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
}

byz_diplomacy = {
	slot = 5
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	byz_gather_alliances = { #Gather Alliances
		icon = mission_alliances
		position = 1 #5-1
		required_missions = { }
		
		provinces_to_highlight = {
			#None
		}
		
		trigger = {
			OR = {
				alliance_with = POL
				alliance_with = HAB
				alliance_with = HUN
				num_of_allies = 3
			}
		}
		
		effect = {
			add_country_modifier = {
				name = "byz_light_in_the_darkness"
				duration = 5475
			}
			add_dip_power = 100
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}

	byz_northern_chersonese = { #The Northern Chersonese
		icon = mission_cossack_cavalry
		position = 4 #5-4
		required_missions = { byz_gather_alliances byz_deny_ottoman_access }
		
		provinces_to_highlight = {
			#None
		}
		
		trigger = {
			any_country = {
				culture_group = east_slavic
				OR = {
					alliance_with = ROOT
					is_subject_of = ROOT
				}
			}
		}
		
		effect = {
			crimea_area = {
				limit = {
					NOT = { is_core = ROOT }
				}
				add_permanent_claim = ROOT
			}
			2447 = {
				add_permanent_claim = ROOT
			}
			286 = {
				add_claim = ROOT
			}
			add_dip_power = 100
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
}

byz_navy_2 = {
	slot = 4
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	byz_modernize_navy = { #New in BR 8.0
		icon = mission_establish_high_seas_navy
		required_missions = { byz_no_latins_in_greece }
		
		provinces_to_highlight = {
		
		}
		
		trigger = {
			shipyard = 7
			dock = 7
			navy_tradition = 40
			max_sailors = 5000
			if = { limit = { has_dlc = "Rule Brittania" }
				has_naval_doctrine = any
			}
		}
		
		effect = {
			151 = {
				if = {
					limit = { 
						NOT = { has_building = naval_battery } 
						NOT = { has_construction = building }
					}
					add_building_construction = {
						building = naval_battery
						speed = 0.25
						cost = 0
					}
				}
				else_if = {
					limit = { 
						NOT = { has_building = naval_battery } 
					}
					add_building = naval_battery
				}
				else = {
					add_treasury = 200 #Fallback
				}
			}
			remove_country_modifier = byz_bad_navy
		}
	}
}

byz_navy_1 = {
	slot = 5
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	byz_expand_naval_dominance = { #Restore the Navy
		icon = mission_galleys_in_port
		required_missions = { byz_no_latins_in_greece byz_northern_chersonese }
		
		provinces_to_highlight = {
			#None
		}
		
		trigger = {
			naval_forcelimit = 70
			num_of_galley = 50
		}
		
		effect = {
			if = {
				limit = { 
					has_dlc = "Golden Century" 
					has_spare_flagship_capacity = yes 
				}
				151 = {
					ROOT = {
						create_flagship = {    
							name = "Eleutherios"
							type = galley
						}
					}
				}
			}
			else = {
				151 = {
					ROOT = {
						create_named_ship = {    
							name = "Eleutherios"
							type = galley
						}
					}
				}
			}
			add_yearly_sailors = 1	
			
			#Claims
			give_permaclaims_for_mission = { mission=byz_retake_greek_islands }
		}
	
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
	
	byz_retake_greek_islands = { #Retake Greek Islands!
		icon = mission_invade_island
		position = 3
		required_missions = { byz_modernize_navy byz_expand_naval_dominance }
		
		provinces_to_highlight = {
			province_group = byz_retake_greek_islands_provinces
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			NOT = { exists = NAX }
			NOT = { exists = CDA }
			NOT = { exists = KNI }
			NOT = { exists = CYP }
			has_fulfiled_province_requirement_for_mission_trigger = {
				tooltip=country_holds_or_non_sovereign_subject_holds_highlighted 
				provinces=byz_retake_greek_islands_provinces
				owner_type=country_or_non_sovereign_subject_holds
			}
		}
		
		effect = {
			add_country_modifier = {
				name = "byz_imperial_navy"
				duration = 7300
			}
			
			148 = { #Thessalonica grows as an important port city and trade prospers as Byzantium controls the Aegean.
				add_base_tax = 4
				add_base_production = 4
				add_base_manpower = 2
			}
			
			#Claims
			give_permaclaims_for_mission = { mission=byz_reconquer_albania }
		}
	}
}

byz_military_1 = {
	slot = 3
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes

	byz_restore_imperial_army = { #The Imperial Army
		icon = mission_pf_soldier
		position = 6 #3-6
		required_missions = { byz_safeguard_balkan_border }
		
		provinces_to_highlight = {
			#None
		}
		
		trigger = {
			army_size = 100
			army_tradition = 75
			num_of_generals = 3
		}
		effect = {
			add_legitimacy = 20
			remove_country_modifier = byz_bad_military
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
	
	byz_varangian_guard = { #New in BR 8.0
		icon = mission_varangians
		position = 7 #3-7
		required_missions = { byz_restore_imperial_army }
		
		trigger = {
			custom_trigger_tooltip = {
				tooltip = br_varangian_guard_enabled_tt
				has_country_flag = br_varangian_guard_enabled
			}
			any_hired_mercenary_company = {
				OR = {
					template = br_varangian_guard
					template = br_varangian_guard_elite
				}
			}
		}
		effect = {
			if = {
				limit = { has_dlc = "Cradle of Civilization" }
				add_army_professionalism = 0.1
			}
			else = {
				add_army_tradition = 25
				add_mil_power = 100
			}
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
}

byz_admin = {
	slot = 3
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	byz_revoke_latifundia = { #New in BR 8.0
		icon = mission_revoke_latifundia
		position = 8 #4-8
		required_missions = { byz_resurgent }
		
		provinces_to_highlight = {
			
		}
		
		trigger = {
			NOT = { has_estate_privilege = estate_nobles_latifundia_kantakouzenos }
			NOT = { has_estate_privilege = estate_nobles_latifundia_philantropenos }
			NOT = { has_estate_privilege = estate_nobles_latifundia_metochites }
			NOT = { has_estate_privilege = estate_nobles_latifundia_choumnos }
			NOT = { has_estate_privilege = estate_nobles_latifundia_melissenos }
			NOT = { has_estate_privilege = estate_nobles_latifundia_tornikes }
		}
		
		effect = {
			custom_tooltip = byzantine_pronoia_tooltip
			set_country_flag = byz_restored_pronoia_mechanic
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}

	byz_imperial_great_projects = { #New in BR 8.0
		icon = mission_parthenon
		position = 10 #4-10
		required_missions = { byz_revoke_latifundia byz_pandidakterion }
		
		provinces_to_highlight = {
			has_great_project = {
				type = any
				tier = 0
			}
			NOT = {
				has_great_project = {
					type = any
					tier = 3
				}
			}
			owned_by = ROOT
		}
		
		trigger = {
			calc_true_if = {
				desc = byz_imperial_great_projects_tooltip
				all_owned_province = {
					has_great_project = {
						type = any
						tier = 3
					}
				}
				amount = 3
			}
		}
		
		effect = {
			add_country_modifier = {
				name = "byz_great_projects"
				duration = 9125
			}
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
}

byz_resurgence = {
	slot = 4
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	byz_resurgent = { #New in BR 8.0
		icon = mission_byzantine_resurgence
		position = 7 #4-7
		required_missions = { byz_reconquer_west_anatolia byz_restore_imperial_army byz_retake_greek_islands }
		
		provinces_to_highlight = {
			
		}
		
		trigger = {
			mission_completed = byz_restore_crown_authority
			if = { #Feature locked behind DLC.
				limit = {
					OR = {
						has_dlc = "Rights of Man"
						has_dlc = "Emperor"
					}
				}
				is_great_power = yes
			}
		}
		
		effect = {
			remove_government_reform = byzantine_autocracy_reform
			add_government_reform = reformed_byzantine_monarchy_reform
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
	
	byz_bureaucracy = { #New in BR 8.0
		icon = mission_byzantine_bureaucracy
		position = 8 #4-8
		required_missions = { byz_resurgent }
		
		provinces_to_highlight = {
			
		}
		
		trigger = {
			reform_level = 3
			OR = {
				adm = 4
				monthly_adm = 12 #Base is +3, so generating 8 adm from other sources should be possible, especially considering national foci exist.
			}
		}
		
		effect = {
			custom_tooltip = byzantine_bureaucracy_tooltip
			set_country_flag = byz_restored_bureaucracy_mechanic
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
	
}

byz_development = {
	slot = 5
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	byz_restore_city_of_cities = { #Restore the City of Cities
		icon = mission_constantinople
		position = 8 #5-8
		required_missions = { byz_resurgent }
		
		provinces_to_highlight = {
			province_id = 151
		}
		
		trigger = {
			151 = {
				development = 75
				if = {
					limit = {
						has_dlc = "Leviathan"
					}
					OR = {
						has_great_project = {
							type = hagia_sophia
							tier = 3
						}
						has_great_project = {
							type = theodosian_walls
							tier = 3
						}
					}
				}
			}
		}
		
		effect = {
			151 = {
				area = {
					limit = { owned_by = ROOT }
					add_province_modifier = {
						name = "growth_of_capital"
						duration = 9125 #25 years
					}
				}
				add_province_modifier = {
					name = "byz_city_of_cities"
					duration = -1
				}
				if = {
					limit = {
						has_great_project = {
							type = hagia_sophia
							tier = 3
						}
					}
					ROOT = { 
						change_adm = 1
						change_dip = 1 
					}
					
				}
				if = {
					limit = {
						has_great_project = {
							type = hagia_sophia
							tier = 3
						}
					}
					ROOT = { 
						change_adm = 1
						change_mil = 1 
					}
				}
			}
			add_prestige = 35
			add_legitimacy = 35
			if = {
				limit = { has_dlc = "Mandate of Heaven"	}
				add_splendor = 50
			}
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
	
	byz_restore_imperial_co_capital = { #The Imperial Co-Capital
		icon = mission_early_game_buildings
		position = 9 #5-9
		required_missions = { byz_restore_city_of_cities }
		
		provinces_to_highlight = {
			province_id = 148
		}
		
		trigger = {
			148 = {
				development = 30
			}
		}
		
		effect = {
			148 = {
				add_province_modifier = {
					name = "byz_co_capital"
					duration = -1
				}
			}
			add_legitimacy = 20
			if = {
				limit = { has_dlc = "Mandate of Heaven"	}
				add_splendor = 50
			}
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
}

byz_innovative_2 = {
	slot = 4
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	byz_pandidakterion = { #New in BR 8.0
		icon = mission_pandidakterion
		position = 9 #4-9
		required_missions = { byz_bureaucracy byz_restore_city_of_cities }
		
		provinces_to_highlight = {
			province_id = 151
			NOT = { has_building = university }
		}
		
		trigger = {
			151 = {
				has_building = university
			}
			university = 4
		}
		
		effect = {
			if = {
				limit = {
					has_dlc = "Rule Britannia"
				}
				change_innovativeness = 3
			}
			else = { #Fallback
				add_adm_power = 25
				add_dip_power = 25
				add_mil_power = 25
			}
			change_adm = 1
			change_dip = 1
			
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
	
	byz_military_education = { #New in BR 8.0
		icon = mission_skoutatoi
		position = 10 #4-10
		required_missions = { byz_pandidakterion }
		
		provinces_to_highlight = {
		}
		
		trigger = {
			OR = {
				fortification_expert = 3
				commandant = 3
			}
			if = {
				limit = {
					has_dlc = "Cradle of Civilization"
				}
				army_professionalism = 0.4
			}
			else = {
				army_tradition = 70
			}
		}
		
		effect = {
			change_government_reform_progress = 40
			add_country_modifier = {
				name = "byz_military_education"
				duration = -1
			}
			
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
}

byz_innovative_1 = {
	slot = 5
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	byz_new_renaissance = { #New in BR 8.0
		icon = mission_byzantine_renaissance
		position = 10 #5-10
		required_missions = { byz_pandidakterion byz_restore_imperial_co_capital }
		
		provinces_to_highlight = {
			#None
		}
		
		trigger = {
			OR = {
				full_idea_group = innovative_ideas
				philosopher = 3
				natural_scientist = 3
			}
		}
		
		effect = {
			change_government_reform_progress = 60
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
	
	byz_basileus_protostrategos = { #New in BR 8.0
		icon = mission_basileus_protostrategos
		position = 11 #5-11
		required_missions = { byz_military_education byz_new_renaissance }
		
		provinces_to_highlight = {
			#None
		}
		
		trigger = {
			is_monarch_leader = yes
			OR = {
				mil = 4
				monthly_mil = 12 #Base is +3, so generating 8 mil from other sources should be possible, especially considering national foci exist.
			}
		}
		
		effect = {
			custom_tooltip = byzantine_militarization_tooltip
			if = {
				limit = {
					has_dlc = "Cradle of Civilization"
				}
				add_army_professionalism = 0.1
			}
			else = {
				add_army_tradition = 10
			}
		}
		
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
}

byz_armenia_2 = {
	slot = 4
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	
	byz_rebuild_armenia = {
		icon = mission_pf_soldier
		position = 12 #4-12
		required_missions = { byz_reconquer_lesser_armenia }
		
		provinces_to_highlight = {
			culture = armenian
		}
		
		trigger = {
			accepted_culture = armenian
			development_in_provinces = { #In 1444, 212 dev is Armenian culture. 300 is therefore reasonable considering you can culture-convert OR dev to reach this number.
                value = 300
                culture = armenian
            }
		}
		
		effect = {
			if = {
				limit = { has_dlc = "Mandate of Heaven" }
				custom_tooltip = byz_rebuild_armenia_effect_tooltip
				hidden_effect = {
					rum_area = {
						add_prosperity = 50
					}
					hudavendigar_area = {
						add_prosperity = 50
					}
					germiyan_area = {
						add_prosperity = 50
					}
					aydin_area = {
						add_prosperity = 50
					}
					ankara_area = {
						add_prosperity = 50
					}
					kastamonu_area = {
						add_prosperity = 50
					}
					karaman_area = {
						add_prosperity = 50
					}
					cukurova_area = {
						add_prosperity = 50
					}
					dulkadir_area = {
						add_prosperity = 50
					}
					pontus_area = {
						add_prosperity = 50
					}
					karasi_area = {
						add_prosperity = 50
					}
					pamphylia_area = {
						add_prosperity = 50
					}
					lydia_area = {
						add_prosperity = 50
					}
				}
			}
			add_country_modifier = {
				name = byz_armenian_auxillaries
				duration = -1
			}
		}
	
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
}

byz_armenia_1 = {
	slot = 3
	generic = no
	ai = yes
	potential = {
		tag = BYZ
	}
	has_country_shield = yes
	
	byz_reconquer_lesser_armenia = { #Protect Lesser Armenia!
		icon = mission_mesopotamia
		position = 10 #5-10
		required_missions = { byz_reclaim_anatolia }
		
		provinces_to_highlight = {
			province_group = byz_armenia_minor_provinces
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			has_fulfiled_province_requirement_for_mission_trigger = {
				tooltip=country_holds_or_non_sovereign_subject_holds_highlighted 
				provinces=byz_armenia_minor_provinces
				owner_type=country_or_non_sovereign_subject_holds
			}
		}
		
		effect = {
			add_country_modifier = {
				name = byz_armenian_ambition
				duration = 5475
			}
			
			#Claims
			give_permaclaims_for_mission = { mission=byz_armenia_major }
			give_permaclaims_for_mission = { mission=byz_subjugate_lazica }
			
			#Misc
			add_accepted_culture = cilician
		}
	
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}
	
	byz_fortify_armenia = {
		icon = mission_conquer_50_development
		position = 11 #3-11
		required_missions = { byz_reconquer_lesser_armenia }
		
		provinces_to_highlight = {
			province_group = byz_armenia_minor_provinces
			NOT = { fort_level = 2 }
		}
		
		trigger = {
			calc_true_if = {
				desc = byz_rebuild_armenia_tooltip
				amount = 4
				all_owned_province = {
					province_group = byz_armenia_minor_provinces
					fort_level = 2
				}
			}
		}
		
		effect = {
			every_owned_province = {
				limit = {
					province_group = byz_armenia_minor_provinces
					fort_level = 2
				}
				add_base_manpower = 2
				add_province_modifier = {
					name = local_fortress
					duration = -1
				}
			}
		}
	
		ai_weight = {
			factor = 500	#AI gogo!
		}
	}

}
















